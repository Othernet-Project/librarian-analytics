// Generated by CoffeeScript 1.10.0
(function(window, $) {
  var collectEvent, idx, listItemClicked, mainPanel, nonPropagatingItemSelectors, propagatingItemSelectors, selector, typeMapping;
  mainPanel = $("#" + window.o.pageVars.mainPanelId);
  propagatingItemSelectors = ['a.file-list-link', 'a.file-list-download'];
  nonPropagatingItemSelectors = ['.playlist-list-item-link', '.gallery-list-item-link'];
  typeMapping = {
    file: "file",
    directory: "folder",
    download: "download"
  };
  collectEvent = function(path, type) {
    return ($(window)).trigger('analytics-collect', [
      {
        path: path,
        type: type
      }
    ]);
  };
  listItemClicked = function(e) {
    var el, itemType, mimeType, url;
    el = $(this);
    if (el.data('type') == null) {
      el = el.parent();
    }
    url = el.data('relpath');
    itemType = typeMapping[el.data('type')];
    mimeType = el.data('mimetype') || '';
    mimeType = mimeType.substring(0, mimeType.indexOf("/"));
    return collectEvent(url, mimeType || itemType);
  };
  mainPanel.on('click', propagatingItemSelectors.join(), listItemClicked);
  for (idx in nonPropagatingItemSelectors) {
    selector = nonPropagatingItemSelectors[idx];
    $(selector).on('click', listItemClicked);
  }
})(this, this.jQuery);
